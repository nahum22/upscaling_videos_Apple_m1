services:
  web:
    build: .
    ports:
      - "3000:3000"
    environment:
      STORAGE_ROOT: /app/storage
      CHOKIDAR_USEPOLLING: "true"
      NEXT_DISABLE_TURBOPACK: "1"
    volumes:
      - .:/app
      - /app/node_modules
      - ./storage:/app/storage

  # Worker runs on host for GPU access
  # Use: cd worker && ./run-worker.sh
